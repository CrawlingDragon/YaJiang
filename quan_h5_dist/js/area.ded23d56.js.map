{"version":3,"sources":["webpack:///./src/views/area/area.vue","webpack:///./src/views/area/area.vue?7698","webpack:///./src/views/area/area.vue?bf82","webpack:///./src/common/js/baidu_locationAddress.js"],"names":["class","action","style","ref","index-header","show","z-index","type","vertical","searchBox","value","onSearch","show-action","clearable","placeholder","onCancel","viewAddress","clickGeoAddress","geoViewAddress","latelyAddressArrayComputed","item","index","goToIndex","key","hotCity","id","choose","name","sticky-offset-top","index-list","indexList","computedList","items","it","title","searchAddress","description","noData","metaInfo","components","Headers","setup","router","store","getters","geoAddress","state","geolocationAgain","commit","setTimeout","push","path","data","list","activated","this","computed","initSearchListAll","arr","forEach","concat","filter","length","latelyAddressArray","x","split","y","watch","mounted","getAreaList","methods","val","page","filtrate","includes","$router","go","setAxiosAddress","$axios","fetchGet","mId","initMid","then","res","code","hotcity","letterlist","lists","__exports__","render","geolocation","Promise","resolve","useStore","axiosAddressComputed","axiosAddress","undefined","BMapGL","Geolocation","getCurrentPosition","r","console","log","getStatus","address","province","city","district","geo","askGeo","askGeolocationAgain"],"mappings":"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","file":"js/area.ded23d56.js","sourcesContent":["<template>\n  <div class=\"area-container\">\n    <Headers ref=\"header\" :index-header=\"false\"></Headers>\n    <van-overlay :show=\"show\" class=\"loading\" z-index=\"99999999999999\">\n      <div class=\"wrapper\" @click.stop>\n        <van-loading type=\"spinner\" vertical />\n      </div>\n    </van-overlay>\n    <div class=\"area-content\" :class=\"{ searchBox: searchBox }\">\n      <form action=\"/\" class=\"from\">\n        <van-search\n          v-model=\"value\"\n          show-action\n          clearable\n          placeholder=\"输入城市名、拼音或字母查询\"\n          @search=\"onSearch\"\n          @update:model-value=\"onSearch\"\n          @cancel=\"onCancel\"\n          class=\"search-input\"\n          :class=\"{ searchBox: searchBox }\"\n        />\n      </form>\n      <div style=\"background:#ebebeb\">\n        <div class=\"now-choose-title\">当前选择:{{ viewAddress }}</div>\n        <div class=\"tip-title\">定位/最近访问</div>\n        <div class=\"choose-wrap\">\n          <div\n            class=\"choosed-area location\"\n            :class=\"{\n              fail:\n                geoViewAddress == '定位失败' ||\n                geoViewAddress == '定位中...' ||\n                geoViewAddress == ''\n            }\"\n            @click=\"clickGeoAddress\"\n          >\n            <div class=\"icon\"></div>\n            <div>{{ geoViewAddress || \"定位失败\" }}</div>\n          </div>\n          <div\n            class=\"choosed-area\"\n            v-show=\"viewAddress\"\n            @click=\"goToIndex(index)\"\n            v-for=\"(item, index) in latelyAddressArrayComputed\"\n            :key=\"item\"\n          >\n            {{ item }}\n          </div>\n        </div>\n        <div class=\"tip-title\">热门城市</div>\n        <ul class=\"hot-city-ul\">\n          <li v-for=\"item in hotCity\" :key=\"item.id\" @click=\"choose(item)\">\n            {{ item.name }}\n          </li>\n        </ul>\n        <van-index-bar :sticky-offset-top=\"40\" :index-list=\"indexList\">\n          <template v-for=\"item in computedList\" :key=\"item.items\">\n            <van-index-anchor :index=\"item.index\" />\n            <van-cell\n              :title=\"it.name\"\n              v-for=\"it in item.items\"\n              :key=\"it.name\"\n              @click=\"choose(it)\"\n            />\n          </template>\n        </van-index-bar>\n      </div>\n      <div class=\"search-content\" v-show=\"searchBox\">\n        <div\n          class=\"item\"\n          v-for=\"item in searchAddress\"\n          :key=\"item.name\"\n          @click=\"choose(item)\"\n        >\n          {{ item.name }}\n        </div>\n        <van-empty description=\"未搜索到符合条件的内容\" v-show=\"noData\" />\n      </div>\n    </div>\n  </div>\n</template>\n<script>\nimport Headers from \"@/components/header/header.vue\";\nimport { geo } from \"@/common/js/baidu_locationAddress.js\";\nimport { mapGetters, mapMutations, mapState, useStore } from \"vuex\";\nimport { computed, onUnmounted } from \"vue\";\nimport { useRouter } from \"vue-router\";\nimport { Toast } from \"vant\";\nexport default {\n  name: \"areas\",\n  metaInfo() {\n    return {\n      title: \"切换地区\"\n    };\n  },\n  components: { Headers },\n  setup() {\n    const router = useRouter();\n    const store = useStore();\n    const geoViewAddress = computed(() => store.getters.geoViewAddress);\n    const geoAddress = computed(() => store.state.geoAddress);\n    const { geolocationAgain } = geo();\n    onUnmounted(() => {\n      if (geoViewAddress.value == \"定位中...\") {\n        store.commit(\"setGeoAddress\", \"定位失败\");\n        return;\n      }\n    });\n    async function clickGeoAddress() {\n      //点击定位地址\n      // 如果是定位失败。重新定位\n      if (geoViewAddress.value == \"定位中...\") {\n        Toast(\"定位中\");\n        return;\n      }\n      if (geoViewAddress.value === \"定位失败\") {\n        store.commit(\"setGeoAddress\", \"定位中...\");\n        await geolocationAgain();\n        return;\n        // to do\n      }\n      store.commit(\"setAxiosAddress\", geoAddress.value);\n      setTimeout(() => {\n        router.push({\n          path: \"/index\"\n        });\n      }, 300);\n    }\n    return {\n      clickGeoAddress,\n      geoViewAddress\n    };\n  },\n  data() {\n    return {\n      value: \"\",\n      hotCity: [],\n      list: [],\n      searchAddress: [],\n      searchBox: false,\n      noData: false,\n      show: true\n    };\n  },\n  activated() {\n    this.value = \"\";\n    this.searchBox = false;\n  },\n  computed: {\n    ...mapState([\"initMid\", \"geoAddress\", \"latelyAddressArray\"]),\n    ...mapGetters([\"viewAddress\"]),\n    initSearchListAll() {\n      let arr = [];\n      this.list.forEach(item => {\n        arr = arr.concat(item.items);\n      });\n      return arr;\n    },\n    computedList() {\n      let arr = [];\n      arr = this.list.filter(item => {\n        return item.items.length != 0;\n      });\n      return arr;\n    },\n    indexList() {\n      let arr = [];\n      this.list.forEach(item => {\n        if (item.items.length != 0) {\n          arr.push(item.index);\n        }\n      });\n      return arr;\n    },\n    latelyAddressArrayComputed() {\n      let arr = [];\n      this.latelyAddressArray.forEach(item => {\n        let x = item.split(\",\");\n        let y = x[x.length - 1];\n        arr.push(y);\n      });\n      return arr;\n    }\n  },\n  watch: {},\n  mounted() {\n    this.getAreaList();\n  },\n  methods: {\n    ...mapMutations([\"setAxiosAddress\"]),\n    onSearch(val) {\n      if (val != \"\") {\n        this.page = 0;\n        this.searchAddress = [];\n        this.searchBox = true;\n        this.filtrate(val);\n        if (this.searchAddress.length == 0) {\n          this.noData = true;\n        } else {\n          this.noData = false;\n        }\n      }\n      if (val == \"\") {\n        this.searchAddress = [];\n        this.searchBox = false;\n      }\n    },\n    filtrate(val) {\n      this.initSearchListAll.forEach(item => {\n        let name = item.name;\n        if (name.includes(val)) {\n          this.searchAddress.push(item);\n        }\n      });\n    },\n    onCancel() {\n      this.searchBox = false;\n      this.$router.go(-1);\n    },\n    choose(it) {\n      // console.log(\"it\", it);\n      this.setAxiosAddress(it.data);\n      setTimeout(() => {\n        this.$router.push({ path: \"/index\" });\n        this.searchBox = false;\n      }, 100);\n    },\n    goToIndex(index) {\n      // // eslint-disable-next-line no-debugger\n      // debugger;\n      this.setAxiosAddress(this.latelyAddressArray[index]);\n\n      setTimeout(() => {\n        this.$router.push({ path: \"/index\" });\n        this.searchBox = false;\n      }, 100);\n    },\n    getAreaList() {\n      this.$axios\n        .fetchGet(\"Mobile/Position/getAreaPostion\", { mId: this.initMid })\n        .then(res => {\n          if (res.data.code == 0) {\n            this.hotCity = res.data.data.hotcity.letterlist;\n            this.list = res.data.data.lists;\n            this.show = false;\n          }\n        });\n    }\n  }\n};\n</script>\n<style lang=\"stylus\" scoped>\n.area-container\n  background: #fff\n  .loading\n    width 100%\n    padding-top 50%\n    height 100vh\n    position: fixed\n    left 0\n    top 0\n    right: 0\n    bottom 0\n  .area-content\n    padding-top 12px\n\n    &.searchBox\n      height 300px\n      overflow hidden\n      padding-top 67px\n      position fixed\n      top 40px\n      right 0\n      left 0\n      z-index 3\n    .search-input\n      background: #EBEBEB;\n      margin 0 12px 0 0\n      width auto\n      border-radius 8px\n      &.searchBox\n        position fixed\n        top 52px\n        left 12px\n        right 0\n    .tip-title\n      font-size 14px\n      color: #999999;\n      margin 15px 0\n      padding-left 12px\n    .choose-wrap\n      padding-left 12px\n    .choosed-area\n      min-width 23%\n      padding 0 3px\n      display inline-block\n      // border: 1px solid #E5E5E5;\n      background: #fff\n      border-radius: 8px;\n      height 35px\n      line-height 35px\n      text-align center\n      font-size: 16px;\n      font-family: Microsoft YaHei;\n      color: #333333;\n      margin-right 2%\n      margin-bottom 10px\n      &.location\n        .icon\n          width 12px\n          height: 15px\n          background url('./icon_1.png') center no-repeat\n          background-size contain\n          margin-right: 3px\n        & > div\n          display: inline-block\n          vertical-align: middle\n      &.fail\n        color #999\n        .icon\n          background url('./icon_2.png') center no-repeat\n          background-size contain\n    .hot-city-ul\n      font-size 0\n      margin-right 12px\n      padding-left 12px\n      li\n        min-width 23%\n        // border: 1px solid #E5E5E5;\n        background: #fff\n        border-radius: 8px;\n        height 35px\n        line-height 35px\n        text-align center\n        font-size: 16px;\n        font-family: Microsoft YaHei;\n        color: #333333;\n        margin-right 1%\n        display inline-block\n        margin-bottom 10px\n  .search-content\n    position fixed\n    left 0\n    right 0\n    bottom 0\n    top 108px\n    background #fff\n    z-index 222\n    overflow auto\n    .item\n      height 40px\n      line-height 40px\n      border-bottom 1px solid #e5e5e5\n      text-indent 20px\n/deep/.van-index-bar__sidebar\n  z-index 1\n.now-choose-title\n  line-height: 40px\n  padding-left 12px\n  color #333\n  background #fff\n</style>\n","import { render } from \"./area.vue?vue&type=template&id=2c06ad87&scoped=true\"\nimport script from \"./area.vue?vue&type=script&lang=js\"\nexport * from \"./area.vue?vue&type=script&lang=js\"\n\nimport \"./area.vue?vue&type=style&index=0&id=2c06ad87&lang=stylus&scoped=true\"\n\nimport exportComponent from \"/Users/wuhelong/Documents/project_two/全市一体化/quan_h5/node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-2c06ad87\"]])\n\nexport default __exports__","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../node_modules/stylus-loader/index.js??ref--11-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./area.vue?vue&type=style&index=0&id=2c06ad87&lang=stylus&scoped=true\"","import BMapGL from \"BMapGL\";\n// import storage from \"good-storage\";\nimport { useStore } from \"vuex\";\nimport { computed } from \"vue\";\n\nexport function geolocation() {\n  // 浏览器精确定位\n  // console.log(\"store\", store);\n  return new Promise(resolve => {\n    // console.log(\"已经定位\", axiosAddressComputed.value);\n    const store = useStore();\n    const axiosAddressComputed = computed(() => store.state.axiosAddress);\n\n    if (\n      axiosAddressComputed.value !== \"\" &&\n      axiosAddressComputed.value !== undefined\n    ) {\n      // 如果已经定位过了，直接返回定位的地址\n      // console.log(\"已经定位\", axiosAddressComputed.value);\n      resolve(axiosAddressComputed.value);\n      return;\n    }\n    var geolocation = new BMapGL.Geolocation();\n    geolocation.getCurrentPosition(function(r) {\n      console.log(\"this.getStatus()\", this.getStatus());\n      if (this.getStatus() == 0) {\n        let axiosAddress =\n          r.address.province +\n          \",\" +\n          r.address.city +\n          (r.address.district ? \",\" + r.address.district : \"\");\n        // good-storage 保存地址\n        // 1.保存 接口使用的地址\n        // console.log(\"address\", address);\n        // 保存接口请求的地址\n        // console.log(\"返回地址\", axiosAddress);\n        store.commit(\"setAxiosAddress\", axiosAddress);\n        store.commit(\"setGeoAddress\", axiosAddress);\n        //保存定位的地址\n        resolve(axiosAddress);\n      } else {\n        // 定位失败，去到下一步，判断个人资料\n        store.commit(\"setGeoAddress\", \"定位失败\");\n        if (this.getStatus() === 6) {\n          // this.getStatus == 6 表示权限未打开\n          resolve(6);\n        } else {\n          resolve(99);\n        }\n      }\n    });\n  });\n}\n\nexport function getCityAddress() {\n  // ip定位，获取市\n  return new Promise(resolve => {\n    function myFun(result) {\n      var cityName = result.name;\n      resolve(cityName);\n    }\n    var myCity = new BMapGL.LocalCity();\n    myCity.get(myFun);\n  });\n}\n\nexport function geo() {\n  const store = useStore();\n  function geolocationAgain() {\n    // 浏览器精确定位\n    // console.log(\"store\", store);\n    return new Promise(resolve => {\n      // console.log(\"已经定位\", axiosAddressComputed.value);\n      var geolocation = new BMapGL.Geolocation();\n      geolocation.getCurrentPosition(function(r) {\n        console.log(\"this.getStatus()\", this.getStatus());\n        if (this.getStatus() == 0) {\n          let axiosAddress =\n            r.address.province +\n            \",\" +\n            r.address.city +\n            (r.address.district ? \",\" + r.address.district : \"\");\n          // good-storage 保存地址\n          // 1.保存 接口使用的地址\n          // console.log(\"address\", address);\n          // 保存接口请求的地址\n          // console.log(\"返回地址\", axiosAddress);\n          // store.commit(\"setAxiosAddress\", axiosAddress);\n          store.commit(\"setGeoAddress\", axiosAddress);\n          //保存定位的地址\n          resolve(axiosAddress);\n        } else {\n          // 定位失败，去到下一步，判断个人资料\n          store.commit(\"setGeoAddress\", \"定位失败\");\n          if (this.getStatus() === 6) {\n            // this.getStatus == 6 表示权限未打开\n            resolve(6);\n          } else {\n            resolve(99);\n          }\n        }\n      });\n    });\n  }\n  return {\n    geolocationAgain\n  };\n}\n\nexport function askGeo() {\n  //\n  function askGeolocationAgain() {\n    // 浏览器精确定位\n    return new Promise(resolve => {\n      // console.log(\"已经定位\", axiosAddressComputed.value);\n      var geolocation = new BMapGL.Geolocation();\n      geolocation.getCurrentPosition(function(r) {\n        // console.log(\"this.getStatus()\", this.getStatus());\n        if (this.getStatus() == 0) {\n          let axiosAddress =\n            r.address.province +\n            \",\" +\n            r.address.city +\n            (r.address.district ? \",\" + r.address.district : \"\");\n          // good-storage 保存地址\n          // 1.保存 接口使用的地址\n          // console.log(\"address\", address);\n          // 保存接口请求的地址\n          // console.log(\"返回地址\", axiosAddress);\n          // store.commit(\"setAxiosAddress\", axiosAddress);\n          // store.commit(\"setGeoAddress\", axiosAddress);\n          //保存定位的地址\n          resolve(axiosAddress);\n        } else {\n          // 定位失败，去到下一步，判断个人资料\n          // store.commit(\"setGeoAddress\", \"定位失败\");\n          if (this.getStatus() === 6) {\n            // this.getStatus == 6 表示权限未打开\n            resolve(6);\n          } else {\n            resolve(99);\n          }\n        }\n      });\n    });\n  }\n  return {\n    askGeolocationAgain\n  };\n}\n"],"sourceRoot":""}