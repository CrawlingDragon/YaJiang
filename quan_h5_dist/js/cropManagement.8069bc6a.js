(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["cropManagement"],{"03d8":function(e,t,n){},"091c":function(e,t,n){"use strict";n("03d8")},2881:function(e,t,n){},"83a3":function(e,t,n){"use strict";n("2881")},aac1:function(e,t,n){},ad32:function(e,t,n){"use strict";n("aac1")},fedd:function(e,t,n){"use strict";n.r(t);var c=n("7a23");Object(c["K"])("data-v-cb2c8348");var i={class:"crop_management-container"},s={class:"nav-bar van-hairline--bottom",ref:"h1"},a=Object(c["m"])(" 农事管理 "),o=Object(c["m"])("农事记录"),r={class:"progress-box van-hairline--bottom",ref:"h2"},d=["onClick"],u={class:"period-box"},l={class:"period-title-bar"},b={class:"title-content",ref:"title"},j=["onClick"],f={class:"item"};function m(e,t,n,m,O,p){var v=Object(c["P"])("router-link"),h=Object(c["P"])("ProgressItem"),k=Object(c["P"])("van-icon"),g=Object(c["P"])("van-sticky"),I=Object(c["P"])("Period");return Object(c["H"])(),Object(c["j"])("div",i,[Object(c["k"])("div",s,[Object(c["n"])(v,{class:"nav",to:{path:"/cropManagement",query:{pId:this.$route.query.pId,gId:this.$route.query.gId}},replace:""},{default:Object(c["Z"])((function(){return[a]})),_:1},8,["to"]),Object(c["n"])(v,{class:"nav",to:{path:"/cropRecord",query:{pId:this.$route.query.pId,gId:this.$route.query.gId}},replace:""},{default:Object(c["Z"])((function(){return[o]})),_:1},8,["to"])],512),Object(c["k"])("div",r,[(Object(c["H"])(!0),Object(c["j"])(c["b"],null,Object(c["N"])(p.navProgressList,(function(e,t){return Object(c["H"])(),Object(c["j"])("div",{key:e.classname,onClick:function(e){return p.clickProgress(t)}},[Object(c["n"])(h,{item:e},null,8,["item"])],8,d)})),128))],512),Object(c["k"])("div",u,[Object(c["n"])(g,{"offset-top":40,onScroll:p.stickyChange},{default:Object(c["Z"])((function(){return[Object(c["k"])("div",l,[Object(c["k"])("div",b,[(Object(c["H"])(!0),Object(c["j"])(c["b"],null,Object(c["N"])(p.navProgressList,(function(e,t){return Object(c["H"])(),Object(c["j"])("div",{key:e.classname,ref:p.setItemRef,class:Object(c["y"])(["item-wrap",{active:t==O.active1}]),onClick:function(n){return p.clickHandle(e,t)}},[Object(c["k"])("div",f,Object(c["T"])(e.classname),1),Object(c["n"])(k,{name:"arrow",class:"arrow"})],10,j)})),128))],512)])]})),_:1},8,["onScroll"]),Object(c["k"])("div",{class:Object(c["y"])({paddingTop:O.isFixed})},[(Object(c["H"])(!0),Object(c["j"])(c["b"],null,Object(c["N"])(O.management,(function(e){return Object(c["H"])(),Object(c["j"])("div",{ref:p.setPeriods,key:e.clasname,class:"periods"},[Object(c["k"])("div",{ref:e.id},[Object(c["n"])(I,{period:e},null,8,["period"])],512)],512)})),128))],2)])])}Object(c["I"])();var O=n("2909"),p=n("5530");n("159b");Object(c["K"])("data-v-1eeb53bc");var v={class:"period-content van-hairline--bottom"},h={class:"progress"},k={class:"left"},g={class:"mid"},I={key:0,class:"finished"},w=Object(c["k"])("span",null,"已完成",-1),y={key:1,class:"finish"},P=Object(c["k"])("span",null,"待完成",-1),H={class:"right"},_=["onClick"],C=["onClick"],T=Object(c["k"])("div",{class:"van-dialog__message"}," 该农事管理内容为选填，可点击确认直接完成 ",-1);function $(e,t,n,i,s,a){var o=Object(c["P"])("ProgressItem"),r=Object(c["P"])("van-icon"),d=Object(c["P"])("van-dialog");return Object(c["H"])(),Object(c["j"])("div",v,[Object(c["k"])("div",h,[Object(c["n"])(o,{item:{classname:n.period.classname,percent:n.period.percent}},null,8,["item"])]),(Object(c["H"])(!0),Object(c["j"])(c["b"],null,Object(c["N"])(n.period.lists,(function(e){return Object(c["H"])(),Object(c["j"])("div",{class:"item",key:e.id},[Object(c["k"])("div",k,Object(c["T"])(e.classname),1),Object(c["k"])("div",g,[1===e.isdeal?(Object(c["H"])(),Object(c["j"])("div",I,[Object(c["n"])(r,{name:"clock-o",class:"clock"}),w])):(Object(c["H"])(),Object(c["j"])("div",y,[Object(c["n"])(r,{name:"passed",class:"passsed"}),P]))]),Object(c["k"])("div",H,[1===e.isdeal?(Object(c["H"])(),Object(c["j"])("div",{key:0,class:"btn btn2",onClick:function(t){return a.detail(e)}}," 详情 ",8,_)):(Object(c["H"])(),Object(c["j"])("div",{key:1,class:"btn btn1",onClick:function(t){return a.issue(e)}},"发布",8,C))])])})),128)),Object(c["n"])(d,{show:s.show,"onUpdate:show":t[2]||(t[2]=function(e){return s.show=e}),message:"该农事管理内容为选填，可点击确认直接完成","show-confirm-button":"","show-cancel-button":"","confirm-button-text":"直接完成","cancel-button-text":"去发布",onConfirm:a.confirmDialog,onCancel:a.cancelDialog},{default:Object(c["Z"])((function(){return[T,Object(c["k"])("div",{class:"close",onClick:[t[0]||(t[0]=Object(c["bb"])((function(){}),["stop"])),t[1]||(t[1]=function(e){return s.show=!1})]},[Object(c["n"])(r,{name:"close",size:"25"})])]})),_:1},8,["show","onConfirm","onCancel"])])}Object(c["I"])(),Object(c["K"])("data-v-2f851b32");var x={class:"progress-item"},q={class:"left"},D={class:"mid"},E={class:"right"};function L(e,t,n,i,s,a){var o=Object(c["P"])("van-progress");return Object(c["H"])(),Object(c["j"])("div",x,[Object(c["k"])("div",q,Object(c["T"])(n.item.classname),1),Object(c["k"])("div",D,[Object(c["n"])(o,{percentage:n.item.percent,color:"#155BBB","show-pivot":!1,"stroke-width":"8"},null,8,["percentage"])]),Object(c["k"])("div",E,[Object(c["O"])(e.$slots,"default",{},void 0,!0),Object(c["m"])(Object(c["T"])(n.item.percent)+"%",1)])])}Object(c["I"])();var N={name:"progress_item",components:{},props:{item:{type:Object,default:function(){return{classname:"",percent:0,id:""}}}},data:function(){return{}},computed:{},watch:{},mounted:function(){},unmounted:function(){},methods:{}},F=(n("83a3"),n("d959")),B=n.n(F);const M=B()(N,[["render",L],["__scopeId","data-v-2f851b32"]]);var Z=M,A=n("ba6a"),K=n("5502"),R={name:"period",components:{ProgressItem:Z},props:{period:{type:Object,default:function(){return{}}}},data:function(){return{show:!1,activeItem:""}},computed:Object(p["a"])({},Object(K["e"])(["uId"])),watch:{},mounted:function(){},unmounted:function(){},methods:{confirmDialog:function(){this.confirmIssue(this.activeItem.id,this.uId)},cancelDialog:function(){this.$router.push({path:"/base_edit",query:{classId:this.activeItem.id,editCase:"no"}})},issue:function(e){var t=e.iswrite;this.activeItem=e,0==t?this.show=!0:this.$router.push({path:"/base_edit",query:{classId:e.id,editCase:"no"}})},detail:function(e){this.$router.push({path:"/base_fram_detail",query:{id:e.rid}})},confirmIssue:function(e,t){var n=this;A["a"].fetchPost("/Mobile/Gbase/subFarmerDatacommit",{classid:e,uId:t}).then((function(e){var t=e.data;0===t.code&&window.location.reload(),n.$toast(t.message)}))}}};n("ad32");const W=B()(R,[["render",$],["__scopeId","data-v-1eeb53bc"]]);var G=W,J={name:"crop_management",components:{Period:G,ProgressItem:Z},props:{},data:function(){return{w:10,refItem:[],periods:[],management:[],active1:0,active:0,isFixed:!1,topArr:[]}},computed:Object(p["a"])(Object(p["a"])({},Object(K["e"])(["uId"])),{},{pId:function(){return this.$route.query.pId},navProgressList:function(){var e=this,t=[];return this.management.forEach((function(n,c){n.classname&&t.push({classname:n.classname,percent:n.percent,option:e.topArr[c],id:n.id})})),t}}),watch:{management:function(){var e=this;this.$nextTick((function(){e.periods.forEach((function(t){e.topArr.push(t.offsetTop-100)}))}))}},mounted:function(){this.getmanagementData(),window.addEventListener("scroll",this.scrollHander,!1)},unmounted:function(){window.removeEventListener("scroll",this.scrollHander,!1)},methods:{setPeriods:function(e){this.periods.push(e)},setItemRef:function(e){this.refItem.push(e)},clickProgress:function(e){this.clickHandle(1,e)},stickyChange:function(e){this.isFixed=e.isFixed},clickHandle:function(e,t){var n=this;this.$nextTick((function(){n.top=n.periods[t].offsetTop,window.scrollTo({top:n.top-70,behavior:"smooth"}),setTimeout((function(){n.active1=t}),201)}))},scrollHander:function(){var e=this,t=document.documentElement.scrollTop;setTimeout((function(){for(var n=Object(O["a"])(e.navProgressList).reverse(),c=0;c<n.length;c++){var i=n[c].option;if(i<=t){e.active1=e.active=n.length-c-1;break}}e.active1=e.active}),200)},getmanagementData:function(){var e=this;A["a"].fetchPost("/Mobile/Gbase/getBaseTasklists",{pId:this.pId,uId:this.uId}).then((function(t){var n=t.data;0==n.code?(e.management=n.data,e.getNavWidth()):alert(n.message)}))},getNavWidth:function(){var e=this;this.$nextTick((function(){e.refItem.forEach((function(t){var n=t.offsetWidth;e.w+=n})),e.$refs.title.style.width=e.w+"px"}))}}};n("091c");const S=B()(J,[["render",m],["__scopeId","data-v-cb2c8348"]]);t["default"]=S}}]);
//# sourceMappingURL=cropManagement.8069bc6a.js.map