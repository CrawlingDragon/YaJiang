var q=Object.defineProperty,D=Object.defineProperties;var G=Object.getOwnPropertyDescriptors;var C=Object.getOwnPropertySymbols;var N=Object.prototype.hasOwnProperty,$=Object.prototype.propertyIsEnumerable;var I=(t,e,o)=>e in t?q(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o,_=(t,e)=>{for(var o in e||(e={}))N.call(e,o)&&I(t,o,e[o]);if(C)for(var o of C(e))$.call(e,o)&&I(t,o,e[o]);return t},x=(t,e)=>D(t,G(e));import{H as R}from"./header.1705d6a2.js";import{H as W}from"./hospital_header.4131d3ee.js";import{F as z}from"./foot.fed08935.js";import{a as O}from"./baidu_locationAddress.f951769d.js";import{a as P,G as k,r as E,W as K,o as Q,H as v,X,m as b,c as n,e as f,h as B,j as i,g as h,l as V,x as H,y as L,k as c,f as g,v as T,t as Y,Y as Z,Z as J,z as ee}from"./index.a3582b47.js";import{_ as w}from"./plugin-vue_export-helper.21dcd24c.js";import{u as te}from"./useTitles.0514a601.js";import{C as oe}from"./compressor.esm.c4e5fc50.js";import"./fast_nav.a53c4cb6.js";import"./index.40ed97f4.js";const se={name:"local",setup(t,{emit:e}){const o=P(),d=k(()=>o.state.axiosAddress),a=k(()=>o.state.userInfoLocation),r=E("first"),s=K({text:"\u5B9A\u4F4D\u4E2D\xB7\xB7\xB7"});Q(()=>{p()});async function p(){const{askGeolocationAgain:u}=O();s.text="\u5B9A\u4F4D\u4E2D\xB7\xB7\xB7";let m=await u();if(m!==6&&m!==99)s.text=m,r.value="sucess",e("update:address",s.text);else{if(r.value=="first"){s.text="\u62B1\u6B49\u672A\u5B9A\u4F4D\u5230",r.value="noFirst",e("update:address",s.text);return}m==6?a.value===""?v.alert({title:"\u5B9A\u4F4D\u5931\u8D25",message:"\u68C0\u6D4B\u5230\u60A8\u672A\u6253\u5F00\u5B9A\u4F4D\u670D\u52A1",confirmButtonText:"\u4E0D\u663E\u793A\u5730\u5740",confirmButtonColor:"#155BBB"}).then(()=>{s.text="",e("update:address",s.text)}):v.alert({title:"\u5B9A\u4F4D\u5931\u8D25",message:"\u68C0\u6D4B\u5230\u60A8\u672A\u6253\u5F00\u5B9A\u4F4D\u670D\u52A1,\u5DF2\u81EA\u52A8\u5207\u6362\u81F3 "+a.value,confirmButtonText:"\u597D\u7684",confirmButtonColor:"#155BBB"}).then(()=>{s.text=a.value,e("update:address",s.text)}):(a.value===""?v.alert({title:"\u5B9A\u4F4D\u5931\u8D25",message:"\u62B1\u6B49\u672A\u5B9A\u4F4D\u5230\u60A8\u7684\u6240\u5728\u5730\u5740,\u540E\u671F\u53EF\u4EE5\u5728\u201C\u6211\u7684-\u7F16\u8F91\u8D44\u6599-\u6240\u5728\u5730\u201D\u5B8C\u5584\u4FE1\u606F",confirmButtonText:"\u4E0D\u663E\u793A\u5730\u5740",confirmButtonColor:"#155BBB"}).then(()=>{s.text="",e("update:address",s.text)}):v.alert({title:"\u5B9A\u4F4D\u5931\u8D25",message:"\u62B1\u6B49\u672A\u5B9A\u4F4D\u5230\u60A8\u7684\u6240\u5728\u5730\u5740,\u5DF2\u81EA\u52A8\u5207\u6362\u81F3 "+a.value,confirmButtonText:"\u597D\u7684",confirmButtonColor:"#155BBB"}).then(()=>{s.text=a.value,e("update:address",s.text)}),e("update:address",s.text))}}return x(_({axiosAddress:d},X(s)),{reLocation:p})},props:{propMid:{type:String,default:""}},data(){return{}},computed:_({},b(["uId"]))},ae=t=>(H("data-v-e2f75b32"),t=t(),L(),t),re=ae(()=>c("div",{id:"container"},null,-1));function ie(t,e,o,d,a,r){const s=n("van-icon"),p=n("van-field");return f(),B("div",null,[i(p,{modelValue:t.text,"onUpdate:modelValue":e[0]||(e[0]=u=>t.text=u),class:V(["address",{fail:t.text==="\u5B9A\u4F4D\u4E2D\xB7\xB7\xB7"||t.text==="\u62B1\u6B49\u672A\u5B9A\u4F4D\u5230"}]),name:"\u6240\u5728\u4F4D\u7F6E",label:"\u6240\u5728\u4F4D\u7F6E",placeholder:"",readonly:"","input-align":"right",onClick:d.reLocation},{"right-icon":h(()=>[i(s,{name:"arrow"})]),_:1},8,["modelValue","class","onClick"]),re])}var ne=w(se,[["render",ie],["__scopeId","data-v-e2f75b32"]]);const le={setup(){te("\u63D0\u95EE")},name:"ask",components:{Header:R,Foot:z,HospitalHeader:W,Loacl:ne},props:{},data(){return{address:"\u5B9A\u4F4D\u4E2D\xB7\xB7\xB7",message:"",crop:"\u96F7\u7B0B",fid:"",uploader:[],imgList:[],imgListTiny:[],ismember:"",isShaoxing:"",userInfo:"",locationTime:"first",submitBoolean:!0}},computed:_(x(_({},b(["uId","mid","initMid","hospitalName"])),{from(){return this.$route.query.from},expert(){return this.$route.query.expert},expertId(){return this.$route.query.expertId}}),b(["uId"])),methods:{onSubmit(t){if(t.message==""){this.$toast("\u95EE\u9898\u63CF\u8FF0\u4E0D\u80FD\u4E3A\u7A7A");return}else if(t.message.length<=9){this.$toast("\u95EE\u9898\u63CF\u8FF0\u4E0D\u80FD\u5C11\u4F5910\u4E2A\u5B57");return}else if(this.address=="\u5B9A\u4F4D\u4E2D\xB7\xB7\xB7"){this.$toast("\u5730\u5740\u5B9A\u4F4D\u4E2D,\u8BF7\u7A0D\u7B49");return}this.subAsk()},goToChooseCrop(){this.$router.push({path:"/ask/ask_choose_crop",query:{crop:this.crop=="\u8BF7\u9009\u62E9"?"":this.crop}})},getCrop(t){this.crop=t.name,this.fid=t.fid},afterRead(t,e){let o=this;new oe(t.file,{quality:.4,success(d){let a=new FormData;a.append("urls[]",d,d.name),o.$axios.fetchPost("/Mobile/Wen/OssUploadFile",a).then(r=>{if(r.data.code==0)o.imgList.push(r.data.data),o.imgListTiny.push(r.data.data_tiny);else{o.$toast(r.data.message);let s=e.index;o.uploader.splice(s,1)}})}})},deleteItem(t,e){let o=e.index;return this.imgList.splice(o,1),this.imgListTiny.splice(o,1),!0},subAsk(){let t={mId:this.from?this.mid:this.initMid,uId:this.uId,content:this.message,fId:this.fid,expertId:this.expertId,picurl:this.imgList.join(","),picurl_tiny:this.imgListTiny.join(","),location:this.address==="\u62B1\u6B49\u672A\u5B9A\u4F4D\u5230"?"\u5B9A\u4F4D\u5931\u8D25":this.address};this.submitBoolean&&(this.submitBoolean=!1,this.$axios.fetchPost("Mobile/Wen/addWenQuestion",t).then(e=>{this.$toast(e.data.message),e.data.code==0?setTimeout(()=>{this.$router.go(-1),this.submitBoolean=!0},1e3):this.submitBoolean=!0}))}}},y=t=>(H("data-v-32b27339"),t=t(),L(),t),de={class:"ask-container"},ue=y(()=>c("div",{class:"title"},"\u95EE\u9898\u63CF\u8FF0",-1)),ce=y(()=>c("div",{class:"left"},"\u4F5C\u7269",-1)),pe={key:0,class:"list"},me=y(()=>c("div",{class:"left"},"\u54A8\u8BE2\u4E13\u5BB6",-1)),fe={class:"right"},_e={class:"sub"},he=ee(" \u63D0\u4EA4 ");function ve(t,e,o,d,a,r){const s=n("Header"),p=n("HospitalHeader"),u=n("van-field"),m=n("van-uploader"),S=n("van-icon"),M=n("Loacl"),A=n("van-button"),F=n("van-form"),U=n("router-view"),j=n("Foot");return f(),B("div",de,[i(s,{indexHeader:!1}),r.from=="hospital"?(f(),g(p,{key:0,navHeader:"\u63D0\u95EE"})):T("v-if",!0),ue,i(F,{onSubmit:r.onSubmit,class:"from"},{default:h(()=>[i(u,{modelValue:a.message,"onUpdate:modelValue":e[0]||(e[0]=l=>a.message=l),rows:"4",autosize:"",type:"textarea",placeholder:"\u8BF7\u8F93\u5165\u5177\u4F53\u95EE\u9898\u63CF\u8FF0",class:"text","show-word-limit":"",maxlength:"300",name:"message"},null,8,["modelValue"]),i(u,{name:"uploader",class:"uploader"},{input:h(()=>[i(m,{modelValue:a.uploader,"onUpdate:modelValue":e[1]||(e[1]=l=>a.uploader=l),"after-read":r.afterRead,"before-delete":r.deleteItem,accept:"image/*","max-count":9},null,8,["modelValue","after-read","before-delete"])]),_:1}),c("div",{class:"choose-crop",onClick:e[3]||(e[3]=(...l)=>r.goToChooseCrop&&r.goToChooseCrop(...l))},[ce,i(u,{modelValue:a.crop,"onUpdate:modelValue":e[2]||(e[2]=l=>a.crop=l),readonly:"",class:V(["right",{location:a.crop!="\u8BF7\u9009\u62E9"}]),"input-align":"right",border:!1,name:"crop"},null,8,["modelValue","class"]),i(S,{name:"arrow",class:"arrow"})]),r.expert?(f(),B("div",pe,[me,c("div",fe,Y(r.expert),1)])):T("v-if",!0),i(M,{propMid:r.from?t.mid:t.initMid,ref:"localRef",address:a.address,"onUpdate:address":e[4]||(e[4]=l=>a.address=l)},null,8,["propMid","address"]),c("div",_e,[i(A,{round:"",block:"",type:"info","native-type":"submit",class:"btn f20"},{default:h(()=>[he]),_:1})])]),_:1},8,["onSubmit"]),i(U,null,{default:h(({Component:l})=>[(f(),g(J,null,[(f(),g(Z(l),{onGetCrop:r.getCrop},null,8,["onGetCrop"]))],1024))]),_:1}),i(j)])}var Le=w(le,[["render",ve],["__scopeId","data-v-32b27339"]]);export{Le as default};
