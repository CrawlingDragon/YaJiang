var j=Object.defineProperty,q=Object.defineProperties;var D=Object.getOwnPropertyDescriptors;var C=Object.getOwnPropertySymbols;var $=Object.prototype.hasOwnProperty,G=Object.prototype.propertyIsEnumerable;var I=(t,e,o)=>e in t?j(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o,h=(t,e)=>{for(var o in e||(e={}))$.call(e,o)&&I(t,o,e[o]);if(C)for(var o of C(e))G.call(e,o)&&I(t,o,e[o]);return t},g=(t,e)=>q(t,D(e));import{H as R}from"./header.d5316539.js";import{H as z}from"./hospital_header.56138803.js";import{F as W}from"./foot.e068325b.js";import{a as O}from"./baidu_locationAddress.10eed561.js";import{a as P,M as k,r as E,X as K,o as Q,N as v,Y as X,m as B,c as n,e as f,h as y,j as i,g as _,l as V,x as L,y as w,k as d,f as b,v as T,t as Y,Z,_ as J,z as ee}from"./index.3518e5b0.js";import{_ as H}from"./plugin-vue_export-helper.21dcd24c.js";import{u as te}from"./useTitles.54f46820.js";import{C as oe}from"./compressor.esm.c4e5fc50.js";import"./fast_nav.40db65c6.js";const se={name:"local",setup(t,{emit:e}){const o=P(),u=k(()=>o.state.axiosAddress),a=k(()=>o.state.userInfoLocation),r=E("first"),s=K({text:"\u5B9A\u4F4D\u4E2D\xB7\xB7\xB7"});Q(()=>{p()});async function p(){const{askGeolocationAgain:c}=O();s.text="\u5B9A\u4F4D\u4E2D\xB7\xB7\xB7";let m=await c();if(m!==6&&m!==99)s.text=m,r.value="sucess",e("update:address",s.text);else{if(r.value=="first"){s.text="\u62B1\u6B49\u672A\u5B9A\u4F4D\u5230",r.value="noFirst",e("update:address",s.text);return}m==6?a.value===""?v.alert({title:"\u5B9A\u4F4D\u5931\u8D25",message:"\u68C0\u6D4B\u5230\u60A8\u672A\u6253\u5F00\u5B9A\u4F4D\u670D\u52A1",confirmButtonText:"\u4E0D\u663E\u793A\u5730\u5740",confirmButtonColor:"#155BBB"}).then(()=>{s.text="",e("update:address",s.text)}):v.alert({title:"\u5B9A\u4F4D\u5931\u8D25",message:"\u68C0\u6D4B\u5230\u60A8\u672A\u6253\u5F00\u5B9A\u4F4D\u670D\u52A1,\u5DF2\u81EA\u52A8\u5207\u6362\u81F3 "+a.value,confirmButtonText:"\u597D\u7684",confirmButtonColor:"#155BBB"}).then(()=>{s.text=a.value,e("update:address",s.text)}):(a.value===""?v.alert({title:"\u5B9A\u4F4D\u5931\u8D25",message:"\u62B1\u6B49\u672A\u5B9A\u4F4D\u5230\u60A8\u7684\u6240\u5728\u5730\u5740,\u540E\u671F\u53EF\u4EE5\u5728\u201C\u6211\u7684-\u7F16\u8F91\u8D44\u6599-\u6240\u5728\u5730\u201D\u5B8C\u5584\u4FE1\u606F",confirmButtonText:"\u4E0D\u663E\u793A\u5730\u5740",confirmButtonColor:"#155BBB"}).then(()=>{s.text="",e("update:address",s.text)}):v.alert({title:"\u5B9A\u4F4D\u5931\u8D25",message:"\u62B1\u6B49\u672A\u5B9A\u4F4D\u5230\u60A8\u7684\u6240\u5728\u5730\u5740,\u5DF2\u81EA\u52A8\u5207\u6362\u81F3 "+a.value,confirmButtonText:"\u597D\u7684",confirmButtonColor:"#155BBB"}).then(()=>{s.text=a.value,e("update:address",s.text)}),e("update:address",s.text))}}return g(h({axiosAddress:u},X(s)),{reLocation:p})},props:{propMid:{type:String,default:""}},data(){return{}},computed:h({},B(["uId"]))},ae=t=>(L("data-v-e2f75b32"),t=t(),w(),t),re=ae(()=>d("div",{id:"container"},null,-1));function ie(t,e,o,u,a,r){const s=n("van-icon"),p=n("van-field");return f(),y("div",null,[i(p,{modelValue:t.text,"onUpdate:modelValue":e[0]||(e[0]=c=>t.text=c),class:V(["address",{fail:t.text==="\u5B9A\u4F4D\u4E2D\xB7\xB7\xB7"||t.text==="\u62B1\u6B49\u672A\u5B9A\u4F4D\u5230"}]),name:"\u6240\u5728\u4F4D\u7F6E",label:"\u6240\u5728\u4F4D\u7F6E",placeholder:"",readonly:"","input-align":"right",onClick:u.reLocation},{"right-icon":_(()=>[i(s,{name:"arrow"})]),_:1},8,["modelValue","class","onClick"]),re])}var ne=H(se,[["render",ie],["__scopeId","data-v-e2f75b32"]]);const le={setup(){te("\u63D0\u95EE")},name:"ask",components:{Header:R,Foot:W,HospitalHeader:z,Loacl:ne},props:{},data(){return{address:"\u5B9A\u4F4D\u4E2D\xB7\xB7\xB7",message:"",crop:"\u96F7\u7B0B",fid:"",uploader:[],imgList:[],imgListTiny:[],ismember:"",isShaoxing:"",userInfo:"",locationTime:"first",submitBoolean:!0}},computed:h(g(h({},B(["uId","mid","initMid","hospitalName"])),{from(){return this.$route.query.from},expert(){return this.$route.query.expert},expertId(){return this.$route.query.expertId}}),B(["uId"])),methods:{onSubmit(t){if(t.message==""){this.$toast("\u95EE\u9898\u63CF\u8FF0\u4E0D\u80FD\u4E3A\u7A7A");return}else if(t.message.length<=9){this.$toast("\u95EE\u9898\u63CF\u8FF0\u4E0D\u80FD\u5C11\u4F5910\u4E2A\u5B57");return}else if(this.address=="\u5B9A\u4F4D\u4E2D\xB7\xB7\xB7"){this.$toast("\u5730\u5740\u5B9A\u4F4D\u4E2D,\u8BF7\u7A0D\u7B49");return}this.subAsk()},goToChooseCrop(){this.$router.push({path:"/ask/ask_choose_crop",query:{crop:this.crop=="\u8BF7\u9009\u62E9"?"":this.crop}})},getCrop(t){this.crop=t.name,this.fid=t.fid},afterRead(t,e){let o=this;new oe(t.file,{quality:.4,success(u){let a=new FormData;a.append("urls[]",u,u.name),o.$axios.fetchPost("/Mobile/Wen/OssUploadFile",a).then(r=>{if(r.data.code==0)o.imgList.push(r.data.data),o.imgListTiny.push(r.data.data_tiny);else{o.$toast(r.data.message);let s=e.index;o.uploader.splice(s,1)}})}})},deleteItem(t,e){let o=e.index;return this.imgList.splice(o,1),this.imgListTiny.splice(o,1),!0},subAsk(){let t={mId:this.from?this.mid:this.initMid,uId:this.uId,content:this.message,fId:this.fid,expertId:this.expertId,picurl:this.imgList.join(","),picurl_tiny:this.imgListTiny.join(","),location:this.address==="\u62B1\u6B49\u672A\u5B9A\u4F4D\u5230"?"\u5B9A\u4F4D\u5931\u8D25":this.address};this.submitBoolean&&(this.submitBoolean=!1,this.$axios.fetchPost("Mobile/Wen/addWenQuestion",t).then(e=>{this.$toast(e.data.message),e.data.code==0?setTimeout(()=>{this.$router.go(-1),this.submitBoolean=!0},1e3):this.submitBoolean=!0}))}}},x=t=>(L("data-v-32b27339"),t=t(),w(),t),de={class:"ask-container"},ue=x(()=>d("div",{class:"title f22"},"\u95EE\u9898\u63CF\u8FF0",-1)),ce=x(()=>d("div",{class:"upload-btn"},null,-1)),pe=x(()=>d("div",{class:"left f22"},"\u4F5C\u7269",-1)),me={key:0,class:"list"},fe=x(()=>d("div",{class:"left"},"\u54A8\u8BE2\u4E13\u5BB6",-1)),_e={class:"right"},he={class:"sub"},ve=ee(" \u63D0\u4EA4 ");function xe(t,e,o,u,a,r){const s=n("Header"),p=n("HospitalHeader"),c=n("van-field"),m=n("van-uploader"),S=n("van-icon"),M=n("Loacl"),A=n("van-button"),F=n("van-form"),N=n("router-view"),U=n("Foot");return f(),y("div",de,[i(s,{indexHeader:!1}),r.from=="hospital"?(f(),b(p,{key:0,navHeader:"\u63D0\u95EE"})):T("v-if",!0),ue,i(F,{onSubmit:r.onSubmit,class:"from"},{default:_(()=>[i(c,{modelValue:a.message,"onUpdate:modelValue":e[0]||(e[0]=l=>a.message=l),rows:"4",autosize:"",type:"textarea",placeholder:"\u8BF7\u8F93\u5165\u5177\u4F53\u95EE\u9898\u63CF\u8FF0",class:"text","show-word-limit":"",maxlength:"300",name:"message"},null,8,["modelValue"]),i(c,{name:"uploader",class:"uploader"},{input:_(()=>[i(m,{modelValue:a.uploader,"onUpdate:modelValue":e[1]||(e[1]=l=>a.uploader=l),"after-read":r.afterRead,"before-delete":r.deleteItem,accept:"image/*","max-count":9},{default:_(()=>[ce]),_:1},8,["modelValue","after-read","before-delete"])]),_:1}),d("div",{class:"choose-crop",onClick:e[3]||(e[3]=(...l)=>r.goToChooseCrop&&r.goToChooseCrop(...l))},[pe,i(c,{modelValue:a.crop,"onUpdate:modelValue":e[2]||(e[2]=l=>a.crop=l),readonly:"",class:V(["right",{location:a.crop!="\u8BF7\u9009\u62E9"}]),"input-align":"right",border:!1,name:"crop"},null,8,["modelValue","class"]),i(S,{name:"arrow",class:"arrow"})]),r.expert?(f(),y("div",me,[fe,d("div",_e,Y(r.expert),1)])):T("v-if",!0),i(M,{propMid:r.from?t.mid:t.initMid,ref:"localRef",address:a.address,"onUpdate:address":e[4]||(e[4]=l=>a.address=l)},null,8,["propMid","address"]),d("div",he,[i(A,{round:"",block:"",type:"info","native-type":"submit",class:"btn f20"},{default:_(()=>[ve]),_:1})])]),_:1},8,["onSubmit"]),i(N,null,{default:_(({Component:l})=>[(f(),b(J,null,[(f(),b(Z(l),{onGetCrop:r.getCrop},null,8,["onGetCrop"]))],1024))]),_:1}),i(U)])}var we=H(le,[["render",xe],["__scopeId","data-v-32b27339"]]);export{we as default};
