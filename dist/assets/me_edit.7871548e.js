var N=Object.defineProperty,V=Object.defineProperties;var D=Object.getOwnPropertyDescriptors;var _=Object.getOwnPropertySymbols;var M=Object.prototype.hasOwnProperty,H=Object.prototype.propertyIsEnumerable;var v=(t,e,a)=>e in t?N(t,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[e]=a,f=(t,e)=>{for(var a in e||(e={}))M.call(e,a)&&v(t,a,e[a]);if(_)for(var a of _(e))H.call(e,a)&&v(t,a,e[a]);return t},w=(t,e)=>V(t,D(e));import{H as A}from"./header.1705d6a2.js";import{m as B,s as P,c as r,e as x,h as L,j as n,k as i,g as p,t as l,f as E,v as u,x as F,y as R}from"./index.a3582b47.js";import{a as j}from"./area.bba88a9b.js";import{u as q}from"./useTitles.0514a601.js";import{C as O}from"./compressor.esm.c4e5fc50.js";import{_ as T}from"./plugin-vue_export-helper.21dcd24c.js";import"./fast_nav.a53c4cb6.js";import"./index.40ed97f4.js";const W={setup(){q("\u7F16\u8F91\u8D44\u6599")},name:"meEdit",components:{Header:A},props:{},data(){return{updated:!1,info:"",avatar:"",userName:"",name:"",sex:"\u8BF7\u9009\u62E9",nameShow:!1,sexShow:!1,areaShow:!1,names:"",actions:[{name:"\u7537",id:1},{name:"\u5973",id:0}],areaList:j,resideprovince:"",residecity:"",residedist:"",identity:0,ismember:0}},computed:f({},B(["uId","mid","initMid"])),watch:{name(t,e){if(e=="")return!1;this.upDate()},sex(t,e){e!="\u8BF7\u9009\u62E9"&&this.upDate()},residedist(t,e){e!=""&&this.upDate()},residecity(t,e){e!=""&&this.upDate()},resideprovince(t,e){e!=""&&this.upDate()}},mounted(){this.getInfo()},created(){},updated(){},methods:w(f({},P(["setUserInfo"])),{getUserInfo(){this.updated&&this.$axios.fetchPost("Mobile/User/userCenter",{uId:this.uId,mId:this.initMid}).then(t=>{t.data.code==0&&this.setUserInfo(t.data.data)})},afterRead(t){let e=this;new O(t.file,{quality:.1,success(a){let m=new FormData;m.append("urls[]",a,a.name),m.append("uId",e.uId),e.$axios.fetchPost("/Mobile/Wen/OssUploadFile",m).then(s=>{s.data.code==0&&(e.avatar=s.data.data,e.updated=!0,e.getUserInfo()),e.$toast(s.data.message)})}})},getInfo(){this.$axios.fetchPost("/Mobile/User/userCenter",{uId:this.uId,mId:this.initMid}).then(t=>{if(t.data.code==0){let e=t.data.data;this.avatar=e.avatar,this.userName=e.username,this.name=e.realname,this.sex=e.gender,this.resideprovince=e.resideprovince||"\u8BF7\u9009\u62E9",this.residecity=e.residecity,this.residedist=e.residedist,this.identity=e.identity,this.ismember=e.ismember}})},upDate(){this.$axios.fetchPost("Mobile/User/updateInfo",{uId:this.uId,gender:this.sex,realname:this.name,resideprovince:this.resideprovince,residecity:this.residecity,residedist:this.residedist}).then(t=>{t.data.code==0&&(this.updated=!0),this.$toast(t.data.message)})},clickName(){this.identity==1||this.ismember==1||(this.nameShow=!0,this.names=this.name)},confirmName(){this.name=this.names},onSelect(t){this.sex=t.id,this.sexShow=!1},confimArea(t){this.areaShow=!1,this.resideprovince=t[0].name,this.residecity=t[1].name,this.residedist=t[2].name},cancelArea(){this.areaShow=!1}})},c=t=>(F("data-v-45fbc82e"),t=t(),R(),t),z={class:"me_edit-container"},G=c(()=>i("div",{class:"left f20"},"\u5934\u50CF",-1)),J={class:"mid"},K=c(()=>i("div",{class:"left f20"},"\u7528\u6237\u540D",-1)),Q={class:"mid f20"},X=c(()=>i("div",{class:"left f20"},"\u540D\u5B57",-1)),Y={class:"mid f20"},Z=c(()=>i("div",{class:"left f20"},"\u6027\u522B",-1)),$={class:"mid f20"},ee=c(()=>i("div",{class:"left f20"},"\u6240\u5728\u5730",-1)),te={class:"mid f20"};function se(t,e,a,m,s,d){const S=r("Header"),I=r("van-image"),h=r("van-icon"),y=r("van-uploader"),g=r("van-field"),C=r("van-dialog"),b=r("van-action-sheet"),U=r("van-area"),k=r("van-popup");return x(),L("div",z,[n(S,{indexHeader:!1}),i("ul",null,[n(y,{class:"upload",accept:"image/*","after-read":d.afterRead},{default:p(()=>[i("li",null,[G,i("div",J,[n(I,{class:"avator",fit:"cover",round:"",src:s.avatar},null,8,["src"])]),n(h,{name:"arrow",class:"arrow"})])]),_:1},8,["after-read"]),i("li",null,[K,i("div",Q,l(s.userName),1)]),i("li",{onClick:e[0]||(e[0]=(...o)=>d.clickName&&d.clickName(...o))},[X,i("div",Y,l(s.name),1),s.identity==0&&s.ismember==0?(x(),E(h,{key:0,name:"arrow",class:"arrow"})):u("v-if",!0)]),i("li",{onClick:e[1]||(e[1]=o=>s.sexShow=!0)},[Z,i("div",$,l(s.sex=="1"?"\u7537":"\u5973"),1),n(h,{name:"arrow",class:"arrow"})]),i("li",{onClick:e[2]||(e[2]=o=>s.areaShow=!0)},[ee,i("div",te,l(s.resideprovince)+l(s.residecity)+l(s.residedist),1),n(h,{name:"arrow",class:"arrow"})])]),n(C,{show:s.nameShow,"onUpdate:show":e[4]||(e[4]=o=>s.nameShow=o),title:"\u4FEE\u6539\u540D\u5B57","show-cancel-button":"",onConfirm:d.confirmName},{default:p(()=>[u(" \u4FEE\u6539\u7528\u6237\u540D "),n(g,{modelValue:s.names,"onUpdate:modelValue":e[3]||(e[3]=o=>s.names=o),placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u540D",class:"name",maxlength:"10"},null,8,["modelValue"])]),_:1},8,["show","onConfirm"]),n(b,{show:s.sexShow,"onUpdate:show":e[5]||(e[5]=o=>s.sexShow=o),actions:s.actions,onSelect:d.onSelect},null,8,["show","actions","onSelect"]),u(" \u9009\u62E9\u6027\u522B "),n(k,{show:s.areaShow,"onUpdate:show":e[6]||(e[6]=o=>s.areaShow=o),"close-icon-position":"top-left",position:"bottom"},{default:p(()=>[n(U,{title:"\u9009\u62E9\u6240\u5728\u5730","area-list":s.areaList,onConfirm:d.confimArea,onCancel:d.cancelArea},null,8,["area-list","onConfirm","onCancel"])]),_:1},8,["show"])])}var he=T(W,[["render",se],["__scopeId","data-v-45fbc82e"]]);export{he as default};
