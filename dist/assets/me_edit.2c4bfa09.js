var N=Object.defineProperty,V=Object.defineProperties;var D=Object.getOwnPropertyDescriptors;var _=Object.getOwnPropertySymbols;var M=Object.prototype.hasOwnProperty,H=Object.prototype.propertyIsEnumerable;var v=(s,e,i)=>e in s?N(s,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):s[e]=i,f=(s,e)=>{for(var i in e||(e={}))M.call(e,i)&&v(s,i,e[i]);if(_)for(var i of _(e))H.call(e,i)&&v(s,i,e[i]);return s},w=(s,e)=>V(s,D(e));import{H as A}from"./header.d5316539.js";import{m as B,s as P,c as r,e as x,h as L,j as n,k as a,g as p,t as l,f as E,v as u,x as F,y as R}from"./index.3518e5b0.js";import{a as j}from"./area.bba88a9b.js";import{u as q}from"./useTitles.54f46820.js";import{C as O}from"./compressor.esm.c4e5fc50.js";import{_ as T}from"./plugin-vue_export-helper.21dcd24c.js";import"./fast_nav.40db65c6.js";const W={setup(){q("\u7F16\u8F91\u8D44\u6599")},name:"meEdit",components:{Header:A},props:{},data(){return{updated:!1,info:"",avatar:"",userName:"",name:"",sex:"\u8BF7\u9009\u62E9",nameShow:!1,sexShow:!1,areaShow:!1,names:"",actions:[{name:"\u7537",id:1},{name:"\u5973",id:0}],areaList:j,resideprovince:"",residecity:"",residedist:"",identity:0,ismember:0}},computed:f({},B(["uId","mid","initMid"])),watch:{name(s,e){if(e=="")return!1;this.upDate()},sex(s,e){e!="\u8BF7\u9009\u62E9"&&this.upDate()},residedist(s,e){e!=""&&this.upDate()},residecity(s,e){e!=""&&this.upDate()},resideprovince(s,e){e!=""&&this.upDate()}},mounted(){this.getInfo()},created(){},updated(){},methods:w(f({},P(["setUserInfo"])),{getUserInfo(){this.updated&&this.$axios.fetchPost("Mobile/User/userCenter",{uId:this.uId,mId:this.initMid}).then(s=>{s.data.code==0&&this.setUserInfo(s.data.data)})},afterRead(s){let e=this;new O(s.file,{quality:.1,success(i){let m=new FormData;m.append("urls[]",i,i.name),m.append("uId",e.uId),e.$axios.fetchPost("/Mobile/Wen/OssUploadFile",m).then(t=>{t.data.code==0&&(e.avatar=t.data.data,e.updated=!0,e.getUserInfo()),e.$toast(t.data.message)})}})},getInfo(){this.$axios.fetchPost("/Mobile/User/userCenter",{uId:this.uId,mId:this.initMid}).then(s=>{if(s.data.code==0){let e=s.data.data;this.avatar=e.avatar,this.userName=e.username,this.name=e.realname,this.sex=e.gender,this.resideprovince=e.resideprovince||"\u8BF7\u9009\u62E9",this.residecity=e.residecity,this.residedist=e.residedist,this.identity=e.identity,this.ismember=e.ismember}})},upDate(){this.$axios.fetchPost("Mobile/User/updateInfo",{uId:this.uId,gender:this.sex,realname:this.name,resideprovince:this.resideprovince,residecity:this.residecity,residedist:this.residedist}).then(s=>{s.data.code==0&&(this.updated=!0),this.$toast(s.data.message)})},clickName(){this.identity==1||this.ismember==1||(this.nameShow=!0,this.names=this.name)},confirmName(){this.name=this.names},onSelect(s){this.sex=s.id,this.sexShow=!1},confimArea(s){this.areaShow=!1,this.resideprovince=s[0].name,this.residecity=s[1].name,this.residedist=s[2].name},cancelArea(){this.areaShow=!1}})},c=s=>(F("data-v-45fbc82e"),s=s(),R(),s),z={class:"me_edit-container"},G=c(()=>a("div",{class:"left f20"},"\u5934\u50CF",-1)),J={class:"mid"},K=c(()=>a("div",{class:"left f20"},"\u7528\u6237\u540D",-1)),Q={class:"mid f20"},X=c(()=>a("div",{class:"left f20"},"\u540D\u5B57",-1)),Y={class:"mid f20"},Z=c(()=>a("div",{class:"left f20"},"\u6027\u522B",-1)),$={class:"mid f20"},ee=c(()=>a("div",{class:"left f20"},"\u6240\u5728\u5730",-1)),se={class:"mid f20"};function te(s,e,i,m,t,d){const S=r("Header"),I=r("van-image"),h=r("van-icon"),y=r("van-uploader"),g=r("van-field"),C=r("van-dialog"),b=r("van-action-sheet"),U=r("van-area"),k=r("van-popup");return x(),L("div",z,[n(S,{indexHeader:!1}),a("ul",null,[n(y,{class:"upload",accept:"image/*","after-read":d.afterRead},{default:p(()=>[a("li",null,[G,a("div",J,[n(I,{class:"avator",fit:"cover",round:"",src:t.avatar},null,8,["src"])]),n(h,{name:"arrow",class:"arrow"})])]),_:1},8,["after-read"]),a("li",null,[K,a("div",Q,l(t.userName),1)]),a("li",{onClick:e[0]||(e[0]=(...o)=>d.clickName&&d.clickName(...o))},[X,a("div",Y,l(t.name),1),t.identity==0&&t.ismember==0?(x(),E(h,{key:0,name:"arrow",class:"arrow"})):u("v-if",!0)]),a("li",{onClick:e[1]||(e[1]=o=>t.sexShow=!0)},[Z,a("div",$,l(t.sex=="1"?"\u7537":"\u5973"),1),n(h,{name:"arrow",class:"arrow"})]),a("li",{onClick:e[2]||(e[2]=o=>t.areaShow=!0)},[ee,a("div",se,l(t.resideprovince)+l(t.residecity)+l(t.residedist),1),n(h,{name:"arrow",class:"arrow"})])]),n(C,{show:t.nameShow,"onUpdate:show":e[4]||(e[4]=o=>t.nameShow=o),title:"\u4FEE\u6539\u540D\u5B57","show-cancel-button":"",onConfirm:d.confirmName},{default:p(()=>[u(" \u4FEE\u6539\u7528\u6237\u540D "),n(g,{modelValue:t.names,"onUpdate:modelValue":e[3]||(e[3]=o=>t.names=o),placeholder:"\u8BF7\u8F93\u5165\u7528\u6237\u540D",class:"name",maxlength:"10"},null,8,["modelValue"])]),_:1},8,["show","onConfirm"]),n(b,{show:t.sexShow,"onUpdate:show":e[5]||(e[5]=o=>t.sexShow=o),actions:t.actions,onSelect:d.onSelect},null,8,["show","actions","onSelect"]),u(" \u9009\u62E9\u6027\u522B "),n(k,{show:t.areaShow,"onUpdate:show":e[6]||(e[6]=o=>t.areaShow=o),"close-icon-position":"top-left",position:"bottom"},{default:p(()=>[n(U,{title:"\u9009\u62E9\u6240\u5728\u5730","area-list":t.areaList,onConfirm:d.confimArea,onCancel:d.cancelArea},null,8,["area-list","onConfirm","onCancel"])]),_:1},8,["show"])])}var me=T(W,[["render",te],["__scopeId","data-v-45fbc82e"]]);export{me as default};
