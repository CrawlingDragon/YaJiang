(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["index_online_address"],{"038c":function(e,t,n){},"2b25":function(e,t,n){"use strict";n("038c")},e096:function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return d}));n("d3b7"),n("b0c0");var s=n("3f15"),c=n.n(s),r=n("5502"),i=n("7a23");function o(){return new Promise((function(e){var t=Object(r["f"])(),n=Object(i["f"])((function(){return t.state.axiosAddress}));if(""===n.value||void 0===n.value){var s=new c.a.Geolocation;s.getCurrentPosition((function(n){if(console.log("this.getStatus()",this.getStatus()),0==this.getStatus()){var s=n.address.province+","+n.address.city+(n.address.district?","+n.address.district:"");t.commit("setAxiosAddress",s),t.commit("setGeoAddress",s),e(s)}else t.commit("setGeoAddress","定位失败"),6===this.getStatus()?e(6):e(99)}))}else e(n.value)}))}function a(){var e=Object(r["f"])();function t(){return new Promise((function(t){var n=new c.a.Geolocation;n.getCurrentPosition((function(n){if(console.log("this.getStatus()",this.getStatus()),0==this.getStatus()){var s=n.address.province+","+n.address.city+(n.address.district?","+n.address.district:"");e.commit("setGeoAddress",s),t(s)}else e.commit("setGeoAddress","定位失败"),6===this.getStatus()?t(6):t(99)}))}))}return{geolocationAgain:t}}function d(){function e(){return new Promise((function(e){var t=new c.a.Geolocation;t.getCurrentPosition((function(t){if(0==this.getStatus()){var n=t.address.province+","+t.address.city+(t.address.district?","+t.address.district:"");e(n)}else 6===this.getStatus()?e(6):e(99)}))}))}return{askGeolocationAgain:e}}},e32b:function(e,t,n){"use strict";n.r(t);n("b0c0");var s=n("7a23");Object(s["K"])("data-v-b9c52742");var c={class:"area-container",teleport:"body"},r={action:"/",class:"from"},i={style:{background:"#ebebeb"}},o={class:"now-choose-title"},a=Object(s["k"])("div",{class:"tip-title"},"定位/最近访问",-1),d={class:"choose-wrap"},u=Object(s["k"])("div",{class:"icon"},null,-1),l=["onClick"],h=Object(s["k"])("div",{class:"tip-title"},"热门城市",-1),b={class:"hot-city-ul"},f=["onClick"],j={class:"search-content"},O=["onClick"];function p(e,t,n,p,v,A){var g=Object(s["P"])("Headers"),m=Object(s["P"])("van-loading"),x=Object(s["P"])("van-overlay"),y=Object(s["P"])("van-search"),k=Object(s["P"])("van-index-anchor"),w=Object(s["P"])("van-cell"),C=Object(s["P"])("van-index-bar"),S=Object(s["P"])("van-empty");return Object(s["H"])(),Object(s["j"])("div",c,[Object(s["n"])(g,{ref:"header","index-header":!1},null,512),Object(s["n"])(x,{show:v.show,class:"loading","z-index":"99999999999999"},{default:Object(s["Z"])((function(){return[Object(s["k"])("div",{class:"wrapper",onClick:t[0]||(t[0]=Object(s["bb"])((function(){}),["stop"]))},[Object(s["n"])(m,{type:"spinner",vertical:""})])]})),_:1},8,["show"]),Object(s["k"])("div",{class:Object(s["y"])(["area-content",{searchBox:v.searchBox}])},[Object(s["k"])("form",r,[Object(s["n"])(y,{modelValue:v.value,"onUpdate:modelValue":[t[1]||(t[1]=function(e){return v.value=e}),A.onSearch],"show-action":"",clearable:"",placeholder:"输入城市名、拼音或字母查询",onSearch:A.onSearch,onCancel:A.onCancel,class:Object(s["y"])(["search-input",{searchBox:v.searchBox}])},null,8,["modelValue","onSearch","onUpdate:modelValue","onCancel","class"])]),Object(s["k"])("div",i,[Object(s["k"])("div",o,"当前选择:"+Object(s["T"])(A.currentSelectAddress),1),a,Object(s["k"])("div",d,[Object(s["k"])("div",{class:Object(s["y"])(["choosed-area location",{fail:"定位失败"==p.geoViewAddress||"定位中..."==p.geoViewAddress||""==p.geoViewAddress}]),onClick:t[2]||(t[2]=function(){return p.clickGeoAddress&&p.clickGeoAddress.apply(p,arguments)})},[u,Object(s["k"])("div",null,Object(s["T"])(p.geoViewAddress||"定位失败"),1)],2),Object(s["k"])("div",{class:"choosed-area",onClick:t[3]||(t[3]=function(e){return A.goToIndexOnline("全部地区")})}," 全部地区 "),(Object(s["H"])(!0),Object(s["j"])(s["b"],null,Object(s["N"])(A.latelyAddressArrayComputed,(function(e,t){return Object(s["H"])(),Object(s["j"])("div",{class:"choosed-area",onClick:function(e){return A.goToIndexOnline(t)},key:e},Object(s["T"])(e),9,l)})),128))]),h,Object(s["k"])("ul",b,[(Object(s["H"])(!0),Object(s["j"])(s["b"],null,Object(s["N"])(v.hotCity,(function(e){return Object(s["H"])(),Object(s["j"])("li",{key:e.id,onClick:function(t){return A.choose(e)}},Object(s["T"])(e.name),9,f)})),128))]),Object(s["n"])(C,{"sticky-offset-top":40,"index-list":A.indexList,style:Object(s["z"])({top:v.barTop+"px"})},{default:Object(s["Z"])((function(){return[(Object(s["H"])(!0),Object(s["j"])(s["b"],null,Object(s["N"])(A.computedList,(function(e){return Object(s["H"])(),Object(s["j"])(s["b"],{key:e.items},[Object(s["n"])(k,{index:e.index},null,8,["index"]),(Object(s["H"])(!0),Object(s["j"])(s["b"],null,Object(s["N"])(e.items,(function(e){return Object(s["H"])(),Object(s["h"])(w,{title:e.name,key:e.name,onClick:function(t){return A.choose(e)}},null,8,["title","onClick"])})),128))],64)})),128))]})),_:1},8,["index-list","style"])]),Object(s["ab"])(Object(s["k"])("div",j,[(Object(s["H"])(!0),Object(s["j"])(s["b"],null,Object(s["N"])(v.searchAddress,(function(e){return Object(s["H"])(),Object(s["j"])("div",{class:"item",key:e.name,onClick:function(t){return A.choose(e)}},Object(s["T"])(e.name),9,O)})),128)),Object(s["ab"])(Object(s["n"])(S,{description:"未搜索到符合条件的内容"},null,512),[[s["X"],v.noData]])],512),[[s["X"],v.searchBox]])],2)])}Object(s["I"])();var v=n("5530"),A=n("1da1"),g=(n("159b"),n("99af"),n("4de4"),n("ac1f"),n("1276"),n("caad"),n("2532"),n("96cf"),n("f392")),m=n("e096"),x=n("5502"),y=n("6c02"),k=n("626a"),w=n("335a"),C={name:"index_online_address",metaInfo:function(){return{title:"切换地区"}},components:{Headers:g["a"]},setup:function(e,t){var n=t.emit,c=Object(y["d"])(),r=Object(x["f"])(),i=Object(s["f"])((function(){return r.getters.geoViewAddress})),o=Object(s["f"])((function(){return r.state.geoAddress})),a=Object(m["b"])(),d=a.geolocationAgain;function u(){return l.apply(this,arguments)}function l(){return l=Object(A["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("定位中..."!=i.value){e.next=3;break}return Object(k["a"])("定位中"),e.abrupt("return");case 3:if("定位失败"!==i.value){e.next=8;break}return r.commit("setGeoAddress","定位中..."),e.next=7,d();case 7:return e.abrupt("return");case 8:setTimeout((function(){n("update:fetchAddress",o.value),c.push({path:"/index_online"})}),300);case 9:case"end":return e.stop()}}),e)}))),l.apply(this,arguments)}return Object(s["F"])((function(){console.log("geoAddress",o),"定位中..."!=i.value||r.commit("setGeoAddress","定位失败")})),{clickGeoAddress:u,geoViewAddress:i}},emits:["update:fetchAddress"],data:function(){return{value:"",hotCity:[],list:[],searchAddress:[],searchBox:!1,noData:!1,show:!0,barTop:64,storageArr:w["a"].get("onlineLatelyAddressArray",[])}},activated:function(){this.value="",this.searchBox=!1,this.storageArr=w["a"].get("onlineLatelyAddressArray",[]),console.log(" this.storageArr",this.storageArr)},computed:Object(v["a"])(Object(v["a"])({},Object(x["e"])(["geoAddress","latelyAddressArray"])),{},{initSearchListAll:function(){var e=[];return this.list.forEach((function(t){e=e.concat(t.items)})),e},computedList:function(){var e=[];return e=this.list.filter((function(e){return 0!=e.items.length})),e},indexList:function(){var e=[];return this.list.forEach((function(t){0!=t.items.length&&e.push(t.index)})),e},latelyAddressArrayComputed:function(){var e=[];return this.storageArr.forEach((function(t){var n=t.split(","),s=n[n.length-1];e.push(s)})),e},currentSelectAddress:function(){return this.$route.query.address},currentAxiosAddress:function(){return this.$route.query.axiosAddress}}),mounted:function(){this.getAreaList()},methods:{onSearch:function(e){""!=e&&(this.page=0,this.searchAddress=[],this.searchBox=!0,this.filtrate(e),0==this.searchAddress.length?this.noData=!0:this.noData=!1),""==e&&(this.searchAddress=[],this.searchBox=!1)},filtrate:function(e){var t=this;this.initSearchListAll.forEach((function(n){var s=n.name;s.includes(e)&&t.searchAddress.push(n)}))},onCancel:function(){this.searchBox=!1,this.$router.go(-1)},choose:function(e){var t=this;setTimeout((function(){t.$router.push({path:"/index_online"}),t.$emit("update:fetchAddress",e.data),t.searchBox=!1}),100)},goToIndexOnline:function(e){if("全部地区"===e)this.$router.push({path:"/index_online"}),this.$emit("update:fetchAddress","全部地区");else{var t=w["a"].get("onlineLatelyAddressArray",[]),n=t[e];this.$router.push({path:"/index_online"}),this.$emit("update:fetchAddress",n)}this.searchBox=!1},getAreaList:function(){var e=this;this.$axios.fetchGet("Mobile/Position/getAreaPostion").then((function(t){0==t.data.code&&(e.hotCity=t.data.data.hotcity.letterlist,e.list=t.data.data.lists,e.show=!1)}))},computedBarTop:function(){var e=this.$refs.historyRef.getBoundingClientRect().height;console.log("h",e),this.barTop=e>0?e+64:64}}},S=(n("2b25"),n("d959")),P=n.n(S);const B=P()(C,[["render",p],["__scopeId","data-v-b9c52742"]]);t["default"]=B}}]);
//# sourceMappingURL=index_online_address.f0d5156d.js.map